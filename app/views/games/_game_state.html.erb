<div class="background">
  <h1>Game <%= game.id %></h1>
  <% if @game.users.count == @game.max %>
    <div class="competitors">
      <div class="competitor">
        <% if  @game.users.second%>
          <div class="player 1">
            <%= render 'games/player_dice', user: @game.users[@game.users.index(current_user)- (@game.users.count - 1)] %>
          </div>
        <% end %>
      </div>
      <div class="competitor">
        <% if  @game.users.third%>
          <div class="player 2">
            <%= render 'games/player_dice', user: @game.users[@game.users.index(current_user)- (@game.users.count - 2)] %>
          </div>
        <% end %>
      </div>
      <div class="competitor">
        <% if  @game.users.fourth%>
          <div class="player 3">
            <%= render 'games/player_dice', user: @game.users[@game.users.index(current_user)- (@game.users.count - 3)] %>
          </div>
        <% end %>
      </div>
    </div>
    <h2><%#= @total %></h2>
    <%# current user %>
    <div class="current-user">
      <div class="player 0">
        <%= render 'games/player_dice', user: current_user %>
      </div>
    </div>
    <div class="current-bet">
      <%= render 'games/current_bet', game: @game %>
    </div>
    <%#----------------------------action----------------------------%>
    <%# if current_user.email == @game.users[@game.turn].email %>
    <div class="action">
      temp
    </div>
    <%# end %>
    <%# --------------------mod actions----------------------------- %>
    <h2>Reset the game</h2>
    <%= simple_form_for(@game) do |f| %>
      <%= f.hidden_field :action, value: 'reset' %>
      <%= f.submit "Reset"%>
    <% end %>
    <div class="action">
      <div class="form-container">
        <%= simple_form_for @game, remote: true, html: { class: 'bet-form' } do |f| %>
          <%= f.input :quantity, input_html: { class: 'bet-quantity' }, label: false %>
          <div class="bet-value">
            <%= f.hidden_field :action, value: 'raise', remote: true %>
            <%= f.submit "2", class: 'dice2 dice-img', name: "value"%>
            <%= f.submit "3", class: 'dice3 dice-img', name: "value"%>
            <%= f.submit "4", class: 'dice4 dice-img', name: "value"%>
            <%= f.submit "5", class: 'dice5 dice-img', name: "value"%>
            <%= f.submit "6", class: 'dice6 dice-img', name: "value"%>
          </div>
        <% end %>
      </div>
      <div>
        <%= simple_form_for(@game) do |f| %>
          <%= f.hidden_field :action, value: 'call', remote: true %>
          <%= f.submit "Call Bluff"%>
        <% end %>
      </div>
    </div>
  <% else %>
    <%# ----------------------awaiting players---------------------------- %>
    <i class="fas fa-spinner fa-spin"></i>
    awaiting players
    <% @game.users.each do |user|%>
      <h3><%= user.email %></h3>
    <% end %>
    <% if current_user == @game.owner %>
      <%= link_to "End Game", game_path(@game), class: 'btn btn-primary long-btn', method: :delete, data: { confirm: "end game?" } %>
    <% end %>
  <% end %>
</div>
